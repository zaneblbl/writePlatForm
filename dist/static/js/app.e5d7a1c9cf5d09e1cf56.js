webpackJsonp([1],{"1kKg":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("keep-alive",[e("router-view")],1)},staticRenderFns:[]};var s=n("VU/8")({name:"App"},i,!1,function(t){n("t1h5")},null,null).exports,a=n("/ocq"),c=n("mvHQ"),r=n.n(c),u=n("//Fk"),l=n.n(u),h={Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var e,n,o,i,s,a,c,r="",u=0;for(t=h.Base64._utf8_encode(t);u<t.length;)i=(e=t.charCodeAt(u++))>>2,s=(3&e)<<4|(n=t.charCodeAt(u++))>>4,a=(15&n)<<2|(o=t.charCodeAt(u++))>>6,c=63&o,isNaN(n)?a=c=64:isNaN(o)&&(c=64),r=r+this._keyStr.charAt(i)+this._keyStr.charAt(s)+this._keyStr.charAt(a)+this._keyStr.charAt(c);return r},decode:function(t){var e,n,o,i,s,a,c="",r=0;for(t=t.replace(/[^A-Za-z0-9+/=]/g,"");r<t.length;)e=this._keyStr.indexOf(t.charAt(r++))<<2|(i=this._keyStr.indexOf(t.charAt(r++)))>>4,n=(15&i)<<4|(s=this._keyStr.indexOf(t.charAt(r++)))>>2,o=(3&s)<<6|(a=this._keyStr.indexOf(t.charAt(r++))),c+=String.fromCharCode(e),64!==s&&(c+=String.fromCharCode(n)),64!==a&&(c+=String.fromCharCode(o));return c=h.Base64._utf8_decode(c)},_utf8_encode:function(t){t=t.replace(/rn/g,"n");for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e+=String.fromCharCode(o):o>127&&o<2048?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e},_utf8_decode:function(t){for(var e="",n=0,o=0,i=0,s=0;n<t.length;)(o=t.charCodeAt(n))<128?(e+=String.fromCharCode(o),n++):o>191&&o<224?(s=t.charCodeAt(n+1),e+=String.fromCharCode((31&o)<<6|63&s),n+=2):(s=t.charCodeAt(n+1),i=t.charCodeAt(n+2),e+=String.fromCharCode((15&o)<<12|(63&s)<<6|63&i),n+=3);return e}}},d=h,f=n("mtWM"),g=n.n(f).a.create({timeout:1e4});g.interceptors.request.use(function(t){return t},function(t){return l.a.reject(t)}),g.interceptors.response.use(function(t){return t.data},function(t){return l.a.reject(t)});var m=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"post"===(t=t.toLowerCase())?g.post(e,n):"get"===t?g.get(e,{params:n}):"put"===t?g.put(e,n):"delete"===t?g.delete(e):(console.log("未知的method"),!1)},v={addToGitHub:function(t,e,n,o){var i="https://api.github.com/repos/"+t+"/"+n.substring(0,n.indexOf("/"))+"/contents/"+n.substring(n.indexOf("/")+1)+"?access_token="+e,s={};return new l.a(function(t,e){s.message="create"+o.title,s.content=d.Base64.encode(r()(o)),m("put",i,r()(s)).then(function(e){t(e)},function(t){e(t)})})},getFromGitHub:function(t,e,n){return new l.a(function(o,i){var s="https://api.github.com/repos/"+t+"/"+n.substring(0,n.indexOf("/"))+"/contents/"+n.substring(n.indexOf("/")+1)+"?access_token="+e;m("get",s).then(function(t){var e=d.Base64.decode(t.content);o(e)},function(t){i(t)})})},getListFromGitHub:function(t,e,n){return new l.a(function(o,i){var s="https://api.github.com/repos/"+t+"/"+n.substring(0,n.indexOf("/"))+"/contents/"+n.substring(n.indexOf("/")+1)+"?access_token="+e;m("get",s).then(function(t){o(t)},function(t){i(t)})})},getShaFromGitHub:function(t,e,n){return new l.a(function(o,i){var s="https://api.github.com/repos/"+t+"/"+n.substring(0,n.indexOf("/"))+"/contents/"+n.substring(n.indexOf("/")+1)+"?access_token="+e;m("get",s).then(function(i){if(console.log(i),"Not Found"==i.message)v.addToGitHub(t,e,n);else{var s=i.sha;o(s)}},function(t){i(t)})})},UpdateToGitHub:function(t,e,n,o){var i="https://api.github.com/repos/"+t+"/"+n.substring(0,n.indexOf("/"))+"/contents/"+n.substring(n.indexOf("/")+1)+"?access_token="+e,s={};return new l.a(function(a,c){v.getShaFromGitHub(t,e,n).then(function(t){s.sha=t,s.message="upload note",s.content=d.Base64.encode(r()(o)),m("put",i,r()(s)).then(function(t){a(t)},function(t){console.log(t),c(t)})},function(t){c(t)})})},DeleteFromGitHub:function(t,e,n){return new l.a(function(o,i){var s="https://api.github.com/repos/"+t+"/"+n.substring(0,n.indexOf("/"))+"/contents/"+n.substring(n.indexOf("/")+1)+"?access_token="+e,a={};v.getShaFromGitHub(t,e,n).then(function(t){a.sha=t,a.message="delete note",s+="&message="+a.message+"&sha="+a.sha,m("delete",s).then(function(t){o(t)},function(t){console.log(t),i(t)})},function(t){i(t)})})}},p=v,C={data:function(){return{list:[],currentPath:"",currentIndex:0}},created:function(){this.getlist()},methods:{getlist:function(){var t=this,e=localStorage.getItem("account"),n=localStorage.getItem("token");p.getListFromGitHub(e,n,"story/").then(function(e){t.list=e,t.currentPath=t.list[0].path})},choose:function(t,e){console.log(t),this.currentPath=t.path,this.currentIndex=e},submit:function(){console.log(this.currentPath),this.$emit("submit",this.currentPath)},close:function(){this.$emit("close")}}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"PathList"},[n("div",{staticClass:"cover",on:{click:t.close}}),t._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"content__item"},t._l(t.list,function(e,o){return n("div",{key:o,class:o==t.currentIndex?"check":"uncheck",on:{click:function(n){return t.choose(e,o)}}},[t._v("\n        "+t._s(e.name)+"\n      ")])}),0),t._v(" "),n("div",{staticClass:"submit",on:{click:t.submit}},[t._v("确定")]),t._v(" "),n("div",{staticClass:"submit",on:{click:t.close}},[t._v("取消")])])])},staticRenderFns:[]};var k={data:function(){return{showChoosePath:!1}},components:{PathList:n("VU/8")(C,_,!1,function(t){n("s2Ji")},null,null).exports},methods:{showPath:function(){this.showChoosePath=!this.showChoosePath},choosePath:function(t){this.$emit("choosePath",t)},showAddDialog:function(){this.$emit("showAddDialog")},toDelete:function(){this.$emit("toDelete")}}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Head"},[n("div",{staticClass:"chooseBtn",on:{click:t.showPath}}),t._v(" "),n("div",{staticClass:"addBtn",on:{click:t.showAddDialog}}),t._v(" "),n("div",{staticClass:"deleteBtn",on:{click:t.toDelete}}),t._v(" "),t.showChoosePath?n("PathList",{on:{close:t.showPath,submit:t.choosePath}}):t._e()],1)},staticRenderFns:[]};var x=n("VU/8")(k,b,!1,function(t){n("l/Ns")},null,null).exports,w={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ContentList"},t._l(t.list,function(e,o){return n("div",{key:o,class:o==t.currentIndex?"check":"uncheck",on:{click:function(n){return t.editContent(e,o)}}},[t._v("\n    "+t._s(e.name)+"\n  ")])}),0)},staticRenderFns:[]};var S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Dialog"},[n("div",{staticClass:"cover",on:{click:t.close}}),t._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"content__item"},[n("span",[t._v("title:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"submit",on:{click:t.submit}},[t._v("确定")]),t._v(" "),n("div",{staticClass:"submit",on:{click:t.close}},[t._v("取消")])])])},staticRenderFns:[]};var A={props:["content"],data:function(){return{nowContent:""}},watch:{content:function(t,e){this.nowContent=JSON.parse(this.content).content}},methods:{toSave:function(){this.$emit("save",this.nowContent)}}},P={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ContentEdit"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.nowContent,expression:"nowContent"}],staticClass:"textarea",attrs:{name:"",id:""},domProps:{value:t.nowContent},on:{input:function(e){e.target.composing||(t.nowContent=e.target.value)}}}),t._v(" "),n("div",{staticClass:"areaBar"},[n("div",{staticClass:"bar__areacount"},[t._v("字数："+t._s(t.nowContent.length))])]),t._v(" "),n("div",{staticClass:"save",on:{click:t.toSave}},[t._v("save")])])},staticRenderFns:[]};var $={data:function(){return{token:"",account:"zaneblbl",path:"story/test",list:[],isShowAddDialog:!1,maxId:0,content:"",loading:!1,currentTitle:"",currentId:"",currentPath:""}},components:{ContentList:n("VU/8")({props:["list"],data:function(){return{currentPath:"",currentIndex:0}},created:function(){this.editContent(this.list[0],0)},methods:{editContent:function(t,e){this.currentPath=t.path,this.currentIndex=e,this.$emit("editContent",t)}}},w,!1,function(t){n("tFXA")},null,null).exports,AddDialog:n("VU/8")({data:function(){return{title:""}},methods:{submit:function(){this.$emit("addToGithub",this.title),this.$emit("close",this.title)},close:function(){this.$emit("close",this.title)}}},S,!1,function(t){n("1kKg")},null,null).exports,ContentEdit:n("VU/8")(A,P,!1,function(t){n("fl8m")},null,null).exports,Head:x},created:function(){this.token=localStorage.getItem("token"),this.account=localStorage.getItem("account"),this.getlist()},methods:{choosePath:function(t){this.path="story/"+t,console.log(this.path),this.list=[],this.getlist()},getlist:function(){var t=this;p.getListFromGitHub(this.account,this.token,""+this.path).then(function(e){t.list=e,t.maxId=e.length})},add:function(t){var e=this;this.loading=!0;var n={};n.id=this.maxId+1,n.title=t,n.content="",p.addToGitHub(this.account,this.token,this.path+"/"+t+"-"+n.id+".json",n).then(function(t){e.$message({message:"添加成功",type:"success"}),e.getlist(),e.loading=!1},function(t){e.loading=!1,e.$message.error("添加失败")})},toDelete:function(){var t=this;this.loading=!0,p.DeleteFromGitHub(this.account,this.token,""+this.currentPath).then(function(e){t.$message({message:"删除成功",type:"success"}),t.getlist(),t.loading=!1},function(e){t.loading=!1,t.$message.error("删除失败")})},getContent:function(t){var e=this;this.loading=!0,p.getFromGitHub(this.account,this.token,"story/"+t.path).then(function(n){e.content=n;var o=JSON.parse(n);e.currentTitle=o.title,e.currentId=o.id,e.currentPath="story/"+t.path,e.loading=!1})},save:function(t){var e=this;this.loading=!0;var n={};n.id=this.currentId,n.title=this.currentTitle,n.content=t,p.UpdateToGitHub(this.account,this.token,this.path+"/"+n.title+"-"+n.id+".json",n).then(function(t){e.loading=!1,e.$message({message:"保存成功",type:"success"})},function(t){e.loading=!1,e.$message.error("保存失败")})},showAddDialog:function(){this.isShowAddDialog=!this.isShowAddDialog}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"MainPage"},[n("Head",{on:{toDelete:t.toDelete,showAddDialog:t.showAddDialog,choosePath:t.choosePath}}),t._v(" "),n("div",{staticClass:"mainbox"},[t.list.length?n("ContentList",{attrs:{list:t.list},on:{editContent:t.getContent}}):t._e(),t._v(" "),n("ContentEdit",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{content:t.content,"element-loading-background":"rgba(0, 0, 0, 0.3)"},on:{save:t.save}})],1),t._v(" "),t.isShowAddDialog?n("AddDialog",{on:{addToGithub:t.add,close:t.showAddDialog}}):t._e()],1)},staticRenderFns:[]};var D=n("VU/8")($,y,!1,function(t){n("yBk3")},null,null).exports,F={data:function(){return{tokenValue:"",loading:!1,loginText:""}},methods:{alert:function(){this.$alert(this.loginText,"登录",{confirmButtonText:"确定",center:!0,callback:function(t){}})},toLogin:function(){var t=this,e="https://api.github.com/?access_token="+this.tokenValue;this.tokenValue?(this.loading=!0,m("get",e).then(function(e){t.loading=!1,localStorage.setItem("token",t.tokenValue),localStorage.setItem("account","zaneblbl"),t.$router.push({path:"/MainPage"})},function(e){t.loading=!1,401===e.response.status?(t.loginText="验证失败，令牌错误",t.alert()):(t.loginText="登录失败",t.alert())})):(this.loginText="令牌不能为空",this.alert())}}},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"Login",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.3)"}},[n("div",{staticClass:"contentBox"},[n("div",{staticClass:"item"},[n("span",[t._v("token: ")]),n("el-input",{staticClass:"item__input",attrs:{type:"text"},model:{value:t.tokenValue,callback:function(e){t.tokenValue=e},expression:"tokenValue"}})],1),t._v(" "),n("div",{staticClass:"login",on:{click:t.toLogin}},[t._v("login")])])])},staticRenderFns:[]};var G=n("VU/8")(F,H,!1,function(t){n("kGKh")},null,null).exports;o.default.use(a.a);var O=new a.a({routes:[{path:"/",name:"Login",component:G},{path:"/MainPage",name:"MainPage",component:D},{path:"/*",redirect:"/"}]}),I=n("zL8q"),T=n.n(I);n("tvR6");o.default.use(T.a),o.default.config.productionTip=!1,new o.default({el:"#app",router:O,components:{App:s},template:"<App/>"})},fl8m:function(t,e){},kGKh:function(t,e){},"l/Ns":function(t,e){},s2Ji:function(t,e){},t1h5:function(t,e){},tFXA:function(t,e){},tvR6:function(t,e){},yBk3:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.e5d7a1c9cf5d09e1cf56.js.map